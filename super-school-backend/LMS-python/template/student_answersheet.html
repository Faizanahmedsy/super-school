<div style="border: 1px solid #ccc; border-radius: 4px; padding: 20px; font-family: Arial, sans-serif; font-size: 12px; background-color: #ffffff;">
  <!-- Header Section -->
  <div style="border-bottom: 1px solid #ccc; margin-bottom: 20px; padding-bottom: 10px;">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <!-- School Logo -->
      {% if school_logo %}
      <div style="flex: 1;">
        <img src="{{school_logo}}" alt="School Logo" style="max-height: 60px;">
      </div>
      {% endif %}

      <!-- Title -->
      <div style="flex: 2; text-align: {% if school_logo %}right{% else %}center{% endif %};">
        <h2 style="font-size: 16px; font-weight: bold; margin-bottom: 10px; color: #2d3748;">Marked Answer Sheet</h2>
      </div>
    </div>

    <table style="width: 100%; border-collapse: collapse; margin-bottom: 10px;">
      <tbody>
        <tr>
          <td style="text-align: left; padding: 10px; width: 50%;"><strong>Learner Name:</strong> {{ student_name }}</td>
          <td style="text-align: left; padding: 10px; width: 50%;"><strong>Admission Number:</strong> {{ admission_number }}</td>
        </tr>
        <tr>
          <td style="text-align: left; padding: 10px;"><strong>Grade & Class:</strong> {{ grade }}{{ class_name }}</td>
          <td style="text-align: left; padding: 10px;"><strong>Term:</strong> {{ term }}</td>
        </tr>
        <tr>
          <td style="text-align: left; padding: 10px;"><strong>Subject:</strong> {{ subject_name }}</td>
          <td style="text-align: left; padding: 10px;"><strong>Year:</strong> {{ year }}</td>
        </tr>
        <tr>
          <td style="text-align: left; padding: 10px;"><strong>Assessment Date:</strong> {{ assessment_date }}</td>
          <td style="text-align: left; padding: 10px;"><strong>Assessment Duration:</strong> {{ assessment_duration }}</td>
        </tr>
        <tr>
          <td style="text-align: left; padding: 10px;"><strong>School:</strong> {{ school_name }}</td>
        </tr>
        <tr>
          <!-- Highlight Total Score -->
          <td colspan="2" style="text-align: left; padding: 15px; font-size: 16px; font-weight: bold; text-align: center; border: 1px solid #ccc;">
            <strong>Total Score:</strong> {{ total_score }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Questions Section -->
  {% for question in questions %}
  <div style="margin-bottom: 20px; border-bottom: 1px solid #e5e5e5; padding-bottom: 20px; page-break-inside: avoid;">
    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
      <div style="font-size: 14px; font-weight: bold; color: #2d3748;">Question {{ question.question_number }}</div>
      <div style="text-align: end;">
        <span style="padding: 4px 12px; border-radius: 50px; background-color:
              {% if question.type == 'full' %}#4caf50; color: white;{% elif question.type == 'partial' %}#ffcc00; color: black;{% else %}#f44336; color: white;{% endif %}">
          {{ question.marks }}
        </span>
      </div>
    </div>
    <p style="font-size: 13px; font-weight: normal; color: #4a4a4a; margin-bottom: 10px; line-height: 1.5;">{{ question.question_text }}</p>

    <!-- Learner's Answer -->
    <div style="background-color: #f9f9f9; border: 1px solid #ddd; padding: 12px; border-radius: 4px; margin-bottom: 10px;">
      <p style="margin: 0; font-size: 13px; color: #444;"><strong>Learner's Answer:</strong> {{ question.student_answer }}</p>
    </div>

    <!-- Teacher Comment -->
    <div style="background-color: #f2f2f2; border: 1px solid #ddd; padding: 12px; border-radius: 4px; margin-bottom: 10px;">
      <p style="margin: 0; font-size: 13px; color: #444;"><strong>Teacher Comment:</strong> {{ question.teacher_comment }}</p>
    </div>

    <!-- AI Comment -->
    <div style="background-color: #e8f3fd; border: 1px solid #a0c4f2; padding: 12px; border-radius: 4px;">
      <p style="margin: 0; font-size: 13px; color: #1e88e5;"><strong>AI Comment:</strong> {{ question.ai_comment }}</p>
    </div>
  </div>
  {% endfor %}

  <!-- Feedback Section -->
  <div style="margin-top: 30px; border-top: 1px solid #ccc; padding-top: 20px;">
    <p style="font-size: 13px; font-weight: normal; color: #2d3748; text-align: justify; line-height: 1.5;">
      <strong>Feedback:</strong> {{ feedback }}
    </p>
  </div>

  <!-- Strengths & Weaknesses Section -->
<div style="margin-top: 30px; display: flex; justify-content: space-between; gap: 20px;">
    <!-- Strengths -->
    <div style="width: 48%; background-color: #e8f5e9; border: 1px solid #c8e6c9; padding: 15px; margin-right: 10px; border-radius: 6px;">
      <h3 style="font-size: 14px; color: #2e7d32; font-weight: bold; margin-bottom: 10px; text-align: center;">Strengths</h3>
      <ul style="list-style-type: none; padding: 0; font-size: 13px; color: #2e7d32;">
        {% for strength in strengths %}
        <li style="margin-bottom: 5px;">✔ {{ strength }}</li>
        {% endfor %}
      </ul>
    </div>

    <!-- Weaknesses -->
    <div style="width: 48%; background-color: #ffebee; border: 1px solid #ffcdd2; padding: 15px; margin-left: 10px;border-radius: 6px;">
      <h3 style="font-size: 14px; color: #c62828; font-weight: bold; margin-bottom: 10px; text-align: center;">Weaknesses</h3>
      <ul style="list-style-type: none; padding: 0; font-size: 13px; color: #c62828;">
        {% for weakness in weaknesses %}
        <li style="margin-bottom: 5px;">✖ {{ weakness }}</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>
